#[cfg(test)]
mod tests {
    use crate::neural_networks::{optimization::expecation_maximization::{exp_max_1d, exp_max_2d}, utils::matrix::transpose};

    #[test]
    fn test_exp_max_2d() {
        let data: Vec<Vec<f64>> = vec![
            vec![0.67757034, 3.2006002],
            vec![2.31985125, 3.08571429],
            vec![0.24864422, 2.01607895],
            vec![2.13529672, 3.67785677],     
        ];
        let mu: Vec<Vec<f64>> = vec![vec![ 0.5 , 2.5], vec![2.0, 3.5]];
        let var: Vec<Vec<Vec<f64>>> = vec![vec![vec![1.0, 0.5], vec![0.5, 1.0]], vec![vec![1.5, 0.5], vec![0.5, 1.5]]];
        let n_iter = 100;

         let (p, m_k, s_k) = exp_max_2d(&data, &mu, &var, &n_iter);

        println!("p {:?}", &p);
        println!("m_k {:?}", &m_k);
        println!("s_k {:?}", &s_k);
    }

    #[test]
    fn test_exp_max_1d() {
        let data: Vec<f64> = vec![
            6.1668841,
            6.04826254,
            6.22210068,
            4.23932596,
            5.39814618,
            3.60873491,
            5.18761002,
            3.59007296,
            6.25759195,
            5.63774483,
            5.08434864,
            3.3869026,
            5.25550377,
            5.83415994,
            2.91638518,
            4.19307797,
            7.82322553,
            5.23132813,
            4.62718375,
            3.71226607,
            5.3917602,
            3.96282831,
            6.44949387,
            5.29126549,
            5.87205512,
            4.86114965,
            4.85873491,
            5.01794068,
            4.68606039,
            5.42767789,
            3.84066632,
            5.24272665,
            5.88433562,
            4.93987314,
            5.56245571,
            4.87963304,
            3.96454068,
            3.33908229,
            4.2986121,
            4.06608908,
            5.14843746,
            4.39502981,
            5.09686777,
            3.25889235,
            4.18100055,
            4.51410222,
            4.67342986,
            3.8598561,
            5.79940435,
            4.56493856,
            4.53019824,
            5.31029408,
            4.584964,
            4.8226618,
            5.289829,
            4.16794198,
            4.4068281,
            5.88428617,
            4.40185918,
            4.48509378,
            5.0833119,
            4.66103114,
            5.48372,
            3.45161892,
            6.25491637,
            5.97626497,
            4.74836882,
            4.82800303,
            3.58168456,
            6.02513685,
            2.23681757,
            6.90467824,
            4.09946027,
            3.95549658,
            5.42658558,
            5.56726278,
            4.95491841,
            6.47290524,
            4.94987034,
            5.94980478,
            3.60098783,
            5.54839632,
            4.32566965,
            7.92721736,
            4.95846258,
            3.95176401,
            4.37822871,
            5.93318903,
            6.39181392,
            4.49714575,
            5.33470061,
            6.60344437,
            4.81770198,
            5.73697993,
            3.80986001,
            4.45165688,
            4.19433558,
            4.46241579,
            8.93772184,
            4.4028759,
            3.80316647,
            5.21543455,
            4.96147799,
            6.25917708,
            3.50070155,
            4.27722334,
            4.40612971,
            5.43779312,
            4.50570609,
            4.15581321,
            5.56058177,
            4.0971193,
            3.37645087,
            5.94225409,
            4.20114925,
            5.77198905,
            6.13666834,
            6.98233746,
            3.85925397,
            6.85143748,
            4.17219765,
            5.95329508,
            7.24636944,
            6.4550132,
            4.22223139,
            4.55567732,
            4.70919948,
            3.87194216,
            3.95317942,
            3.72985179,
            2.82099127,
            5.45957522,
            6.23218038,
            6.1747596,
            5.71331123,
            4.7540614,
            5.61476454,
            6.15759581,
            5.62838783,
            4.83748248,
            6.72129664,
            4.44260116,
            4.88329431,
            5.90859392,
            4.94557808,
            6.1089319,
            2.70909662,
            4.63429485,
            6.12197589,
            3.8640978,
            5.40308156,
            4.75325982,
            3.3302778,
            3.78070689,
            5.31901597,
            4.84733978,
            5.87801116,
            5.54542332,
            5.39346315,
            5.26508124,
            4.9364202,
            4.4463168,
            7.23030598,
            4.98141369,
            6.14599405,
            6.55104706,
            5.22957154,
            5.18326231,
            6.20718474,
            5.59389256,
            5.43842866,
            6.03363993,
            5.59606606,
            4.98404283,
            4.38473454,
            5.1474224,
            2.62835292,
            5.25017329,
            6.03904385,
            4.7740593,
            4.41814783,
            5.26474877,
            3.96009476,
            4.46354796,
            4.10844861,
            5.73569293,
            3.13874495,
            4.34519748,
            4.44417375,
            4.37065401,
            3.25588739,
            4.67096646,
            5.345112,
            3.42297501,
            4.63569904,
            5.89770255,
            4.95543911,
            5.36298145,
            5.12682139,
            3.62404762,
            9.06448421,
            7.91099023,
            7.64778341,
            6.83948148,
            8.40810417,
            8.54877928,
            10.24480469,
            6.6966236,
            9.20547904,
            11.29242832,
            10.35070275,
            9.14448941,
            9.2591562,
            9.80233453,
            10.04196029,
            11.35898808,
            11.4699418,
            10.01048233,
            9.20797895,
            7.47860004,
            10.17915287,
            7.84339077,
            7.73716425,
            10.61590846,
            12.82900575,
            8.11411476,
            8.68494352,
            11.38034703,
            7.75970612,
            8.62559582,
            13.45268882,
            10.46327423,
            10.34072672,
            8.74119028,
            14.45753125,
            12.21760052,
            10.67450989,
            10.90974303,
            8.71866662,
            9.43870835,
            12.06382897,
            8.9069183,
            12.03393123,
            8.80206713,
            9.74427753,
            12.46845855,
            10.17608323,
            8.0668333,
            10.15718893,
            6.87426462,
            7.9657882,
            8.58564648,
            10.03218485,
            14.75981824,
            13.42000093,
            9.59018658,
            9.12352497,
            9.76641486,
            11.34111783,
            6.7942114,
            6.00810311,
            8.84672361,
            13.61160693,
            11.27635296,
            9.65817663,
            7.90900872,
            8.85153531,
            10.6574289,
            10.23236894,
            9.23599953,
            8.6501038,
            11.51988736,
            12.12463169,
            12.19468017,
            8.50224843,
            12.51742268,
            10.84919335,
            6.35634608,
            9.84938517,
            9.84756696,
            9.21727687,
            12.52474054,
            10.97988517,
            9.4239567,
            9.13518782,
            9.26262095,
            7.12851342,
            10.80705358,
            5.24573363,
            11.04086871,
            11.52948792,
            10.1120195,
            9.69767476,
            10.43579744,
            8.43488259,
            7.75554545,
            8.48777692,
            8.05360943,
            9.46104977,
            11.73943423,
            8.0247821,
            10.34087888,
            12.10048967,
            9.45290141,
            12.55664237,
            6.07159106,
            10.58411695,
            12.01598861,
            10.38000419,
            12.33302823,
            6.54212017,
            11.95427814,
            14.88842054,
            6.98507505,
            13.29428215,
            10.92897522,
            9.43371752,
            9.61407846,
            8.17217556,
            11.24822376,
            8.46891463,
            10.59723058,
            10.98032461,
            8.72654802,
            8.46426458,
            6.74876174,
            9.27193521,
            12.0967911,
            7.95773937,
            12.40265071,
            10.30882109,
            10.33888764,
            10.16280503,
            11.31089454,
            11.05475733,
            10.2706066,
            9.68122648,
            12.54669931,
            8.67423339,
            10.15574867,
            8.8381865,
            11.3396453,
            7.47244592,
            8.94545238,
            10.23765563,
            9.10524914,
            10.30389076,
            11.16598459,
            11.59180389,
            7.22628335,
            10.7199936,
            8.91499773,
            6.91302976,
            11.67953069,
            7.1593822,
            9.58333803,
            7.40318942,
            9.32951538,
            11.15816634,
            12.71772108,
            7.81851469,
            10.91327067,
            6.04221193,
            9.14156182,
            6.47259648,
            12.9452104,
            9.21388422,
            8.15179074,
            6.95040289,
            12.35644056,
            8.57613756,
            8.84772002,
            10.55578418,
            6.35863718,
            12.30817368,
            14.00139355,
            10.94380143,
            11.63250224,
            12.08387827,
            7.36615595,
            10.82020296,
            9.76646082,
            10.90746866,
            10.509388,
            10.58850451,
            11.38407545,
            8.33350584,
            9.40309533,
            8.66636589,
            5.00539684,
            11.69432591,
            9.7720186,
            11.24837136,
            10.33702391,
            9.10390982,
            8.39396369,
            9.6675923,
            10.89760113,
            10.23308568,
            7.20872044,
            10.4743335,
            8.8196023,
            10.78666729,
            10.3206608,
            11.08956933,
            9.40007856,
            11.3005473,
            10.06677344,
            9.84895072,
            9.35689284,
            7.89373166,
            13.7240765,
            15.04453503,
            9.37928713,
            6.80878739,
            11.59940253,
            10.19609775,
            6.04757161,
            12.36194728,
            9.80423674,
            11.79519977,
            9.67864446,
            15.04440067,
            14.34244103,
            11.61536885,
            8.78810883,
            9.93342589,
            10.84031054,
            8.24240783,
            8.14923757,
            8.92362799,
            8.43217259,
            12.30656478,
            9.89132507,
            12.00324775,
            9.23476624,
            13.14322453,
            9.63673464,
            7.11530839,
            9.34308812,
            11.09954456,
            9.34335265,
            9.78628744,
            15.29277926,
            8.44107394,
            12.22031605,
            7.93532207,
            9.87760936,
            10.09244074,
            12.12328468,
            12.16655364,
            9.19356118,
            9.20194755,
            8.07847703,
            8.95978019,
            13.53503158,
            10.34363933,
            12.70362062,
            12.31217341,
            10.17362699,
            8.21201318,
            14.61435762,
            9.81451599,
            10.69085009,
            10.75625216,
            12.1539739,
            8.66143938,
            7.89653472,
            9.67563257,
            6.76720393,
            9.8685752,
            10.8835326,
            9.58461201,
            8.30887795,
            10.25337534,
            7.73312235,
            10.96776603,
            7.74304873,
            8.54927277,
            12.65020568,
            8.36704087,
            8.05085143,
            10.27319724,
            8.20303086,
            8.71195839,
            8.93120965,
            9.52900672,
            10.41254476,
            9.85063083,
            10.21951132,
            7.5345928,
            10.9555839,
            10.82395523,
            13.59605259,
            8.37871353,
            7.2210887,
            8.72463236,
            12.04505497,
            11.93899712,
            8.7451844,
        ];

        let mu: Vec<f64> = vec![4.96147799, 9.23476624];
        let var: Vec<f64> = vec![0.95071431, 0.73199394];
        let n_iter = 100;

        let (p, m_k, s_k) = exp_max_1d(&data, &mu, &var, &n_iter);

        println!("p {:?}", &p);
        println!("m_k {:?}", &m_k);
        println!("s_k {:?}", &s_k);
    }
}
